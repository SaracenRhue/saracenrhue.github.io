<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Docker" /><meta property="og:locale" content="en" /><meta name="description" content="Installation" /><meta property="og:description" content="Installation" /><link rel="canonical" href="/posts/docker/" /><meta property="og:url" content="/posts/docker/" /><meta property="og:site_name" content="Saracen Rhue" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-18T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Docker" /><meta name="twitter:site" content="@SaracenRhue" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-10-28T16:00:58+01:00","datePublished":"2022-09-18T00:00:00+02:00","description":"Installation","headline":"Docker","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/docker/"},"url":"/posts/docker/"}</script><title>Docker | Saracen Rhue</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Saracen Rhue"><meta name="application-name" content="Saracen Rhue"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Saracen Rhue</a></div><div class="site-subtitle font-italic">coding dictionary</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/saracenrhue" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/SaracenRhue" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['mail','saracenrhue.ch'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://stackoverflow.com/users/15762068/saracen-rhue?tab=topactivity" aria-label="stack-overflow" target="_blank" rel="noopener"> <i class="fab fa-stack-overflow"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Docker</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Docker</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1663452000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 18, 2022 </em> </span> <span> Updated <em class="" data-ts="1730127658" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 28, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/SaracenRhue">Saracen Rhue</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1717 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><h2 id="installation"><span class="mr-2">Installation</span><a href="#installation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">-fsSL</span> https://get.docker.com | sh
</pre></table></code></div></div><h2 id="virtual-machines-vs-containers-a-brief-overview"><span class="mr-2">Virtual Machines vs. Containers: A Brief Overview</span><a href="#virtual-machines-vs-containers-a-brief-overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Virtual Machines (VMs) and containers are both virtualization technologies used for creating isolated environments for running applications, but they differ significantly in their approach and resource efficiency.</p><ol><li><p><strong>Virtual Machines (VMs)</strong>: VMs operate by emulating entire hardware systems, allowing you to run multiple operating systems on a single physical machine. Each VM includes a full copy of an operating system, the application, necessary binaries, and libraries - taking up tens of GBs. VMs are managed by a hypervisor and are great for full isolation and running multiple different operating systems on the same hardware.</p><li><p><strong>Containers</strong>: Containers, on the other hand, share the same operating system kernel and isolate the application processes from the rest of the system. They’re incredibly lightweight (only megabytes in size), start almost instantly, and use a fraction of the memory compared to booting an entire OS.</p></ol><h2 id="introduction-to-dockerfiles"><span class="mr-2">Introduction to Dockerfiles</span><a href="#introduction-to-dockerfiles" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>With a clear understanding of how containers differ from traditional VMs, let’s delve into Dockerfiles. A Dockerfile is a text document containing all the commands a user could call on the command line to assemble an image. Using docker build, users can create an automated build that executes several command-line instructions in succession. This guide will explore the basic structure and key elements of a Dockerfile, illustrating how to efficiently containerize your applications.</p><h3 id="basic-structure-of-a-dockerfile"><span class="mr-2">Basic Structure of a Dockerfile</span><a href="#basic-structure-of-a-dockerfile" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The Dockerfile is the starting point for creating a Docker image. It’s a simple text file with instructions on how to build your Docker image. Here’s a basic example:</p><div class="language-dockerfile highlighter-rouge"><div class="code-header"> <span data-label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> node:current-alpine3.16</span>

<span class="k">WORKDIR</span><span class="s"> /app</span>

<span class="k">COPY</span><span class="s"> . .</span>

<span class="k">RUN </span>npm <span class="nb">install</span>

<span class="k">ENV</span><span class="s"> PORT=3000</span>
<span class="k">EXPOSE</span><span class="s"> 3000</span>

<span class="k">VOLUME</span><span class="s"> /app/public</span>

<span class="k">CMD</span><span class="s"> ["npm", "start"]</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">FROM</code> defines the image, your image will be based on. In this case it’s the Alpine version of the node Image, this means it’s Alpine Linux version 3.16 with nodeJS preinstalled.</p><p><code class="language-plaintext highlighter-rouge">WORKDIR</code> is basically the same as the cd command in Linux. All subsequent commands will be run from this directory.</p><p><code class="language-plaintext highlighter-rouge">COPY</code> copies files in your local directory into the container. In this case everything from the local directory gets copied into the working directory <code class="language-plaintext highlighter-rouge">/app</code>. If you want to exclude specific files like the Dockerfile you can add a file <code class="language-plaintext highlighter-rouge">.dockerignore</code> where you list all the files that are in your directory but are to be ignored in the build process.</p><p><code class="language-plaintext highlighter-rouge">RUN</code> can be used to run any bash command needed to setup everything for the application to run inside the container. Usually the commands are chained together with <code class="language-plaintext highlighter-rouge">&amp;&amp; \</code> so every command can be written in a separate line. While it is possible to use RUN multiple times keep in mind that every RUN uses a separate shell session meaning things like cd not get saved across sessions so it’s not recommended unless it’s necessary for some reason.</p><p><code class="language-plaintext highlighter-rouge">EXPOSE</code> exposes ports that will need to be accessible from outside the container later. For example in this case the port 3000 inside the container can then be mapped to port 3000 or any other port outside the container.</p><p><code class="language-plaintext highlighter-rouge">VOLUME</code> is used to map a folder from inside the container to a folder on the machine where the container is running. This can be used for files you may need to change later like in this case the files that will be displayed by this nodeJS app, or for files that need to be consistent because every file inside a container gets reset to it’s original state every time the container restarts.</p><p><code class="language-plaintext highlighter-rouge">CMD</code> is the final command that starts the application inside the container without opening a extra shell session.</p><h2 id="environment-variables"><span class="mr-2">Environment Variables</span><a href="#environment-variables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now that we are done with the basics let’s move on to environment variables. First off what exactly are environment variables? Environment variables are key-value pairs that can affect the behaviour of running processes on a computer. They’re particularly useful in development and operations workflows for configuring and parameterising applications.</p><p>A common use case for environment variables is parsing on values to an application that you want to be able to change easily or values that you may want to keep secret (e.g. API keys).</p><p>You can set a Variable inside the Dockerfile if it’s something you don’t need to change anymore like the port our nodeJS application is supposed to use.</p><p><code class="language-plaintext highlighter-rouge">ENV PORT=3000</code> defines the variable PORT and initialises it with 3000 The application can then access this variable like this</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">port</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span><span class="p">;</span>
</pre></table></code></div></div><p>Another way to set Environment variables, if you don’t want the values to be permanently written somewhere, is in the docker run command, but more on that later</p><h2 id="choosing-a-base-image"><span class="mr-2">Choosing a Base Image</span><a href="#choosing-a-base-image" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li><strong>Size Matters</strong>: For a lightweight container, minimalistic base images like <code class="language-plaintext highlighter-rouge">alpine</code> or <code class="language-plaintext highlighter-rouge">busybox</code> are preferred. They are stripped down to the essentials, providing a smaller attack surface and faster deployment times.</ol><div class="language-dockerfile highlighter-rouge"><div class="code-header"> <span data-label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> alpine:latest</span>
</pre></table></code></div></div><ol><li><strong>Compatibility and Libraries</strong>: If your application requires specific libraries or compatibility with certain software, consider using a more complete base image such as <code class="language-plaintext highlighter-rouge">ubuntu</code>, <code class="language-plaintext highlighter-rouge">debian</code>, or <code class="language-plaintext highlighter-rouge">fedora</code>. These distributions offer a wider array of pre-built packages and are generally easier to work with for complex applications.</ol><div class="language-dockerfile highlighter-rouge"><div class="code-header"> <span data-label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> ubuntu:20.04</span>
</pre></table></code></div></div><ol><li><strong>Long-Term Support</strong>: Choose distributions that offer long-term support (LTS) for production environments. LTS distributions like <code class="language-plaintext highlighter-rouge">ubuntu:20.04 LTS</code> or <code class="language-plaintext highlighter-rouge">debian:buster-slim</code> provide ongoing updates and security patches, ensuring stability and reducing maintenance efforts.</ol><div class="language-dockerfile highlighter-rouge"><div class="code-header"> <span data-label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> ubuntu:20.04</span>
</pre></table></code></div></div><ol><li><strong>Security</strong>: Opt for base images with a strong reputation for security and stability, such as <code class="language-plaintext highlighter-rouge">debian</code> or <code class="language-plaintext highlighter-rouge">centos</code>. These distributions are known for regularly scanning their images for vulnerabilities and applying security patches.</ol><div class="language-dockerfile highlighter-rouge"><div class="code-header"> <span data-label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> debian:buster-slim</span>
</pre></table></code></div></div><ol><li><strong>Architecture Support</strong>: Consider the CPU architecture for which you are building your image. Some base images like <code class="language-plaintext highlighter-rouge">arm32v7/debian</code> or <code class="language-plaintext highlighter-rouge">amd64/alpine</code> are optimised for specific architectures, ensuring better performance and compatibility on the target hardware and if you want your image to run on multiple architectures the base image needs to be compatible as well.</ol><h2 id="building-a-container"><span class="mr-2">Building a Container</span><a href="#building-a-container" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After creating a application and a Dockerfile simply run <code class="language-plaintext highlighter-rouge">docker build -t your-image-name:tag .</code>. You can see all your local images by running <code class="language-plaintext highlighter-rouge">docker images</code>. (Often a version identifier or <code class="language-plaintext highlighter-rouge">latest</code> is used as tag)</p><h3 id="pushing-builds-to-a-registry"><span class="mr-2">Pushing Builds to a Registry</span><a href="#pushing-builds-to-a-registry" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If you haven’t already, log in to your Docker registry (e.g. Docker Hub) and create a new repository for your image. Before you can push an image, it needs to be tagged with the registry name. Use the <code class="language-plaintext highlighter-rouge">docker tag</code> command like this:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker tag your-image-name:tag registry-username/repository-name:tag
</pre></table></code></div></div><p>If you’re not logged in to the Docker registry from your command line, you’ll need to do so. Just type <code class="language-plaintext highlighter-rouge">docker login</code> in your terminal (For a private registry use <code class="language-plaintext highlighter-rouge">docker login [registry-url]</code>). Now to push your image by running:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker push registry-username/repository-name:tag
</pre></table></code></div></div><h3 id="multi-architecture-builds"><span class="mr-2">Multi Architecture Builds</span><a href="#multi-architecture-builds" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First off we need to create a new builder that supports non native architectures.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>docker buildx create <span class="nt">--name</span> mybuilder <span class="nt">--use</span>
docker run <span class="nt">-it</span> <span class="nt">--rm</span> <span class="nt">--privileged</span> tonistiigi/binfmt <span class="nt">--install</span> all
</pre></table></code></div></div><p>Now we can build and push an image that supports multiple architectures in one go. (If you don’t run this from the directory where your Dockerfile is you need to replace the dot with the correct path). If you want to use different Dockerfiles for different architectures you can specify which file is used for what architecture by adding a extension like <code class="language-plaintext highlighter-rouge">.arm64</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker buildx build <span class="nt">--platform</span> linux/amd64,linux/arm64 <span class="nt">-t</span> registry-username/repository-name:tag <span class="nb">.</span> <span class="nt">--push</span>
</pre></table></code></div></div><h2 id="running-a-container"><span class="mr-2">Running a Container</span><a href="#running-a-container" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If the image has been built successfully the container can be run by using:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="sb">`</span>docker run <span class="nt">-d</span> your-image-name:tag<span class="sb">`</span>
</pre></table></code></div></div><p>If you want to pull a container and run it use:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker run <span class="nt">-d</span> registry-username/repository-name:tag
</pre></table></code></div></div><p>(<code class="language-plaintext highlighter-rouge">-d</code> runs the container in detached mode, essentially running it in the background so you can keep using your terminal session). To see which containers are running, use <code class="language-plaintext highlighter-rouge">docker ps</code>.</p><p>You can start and stop containers using <code class="language-plaintext highlighter-rouge">docker start name_or_id</code> or <code class="language-plaintext highlighter-rouge">docker stop name_or_id</code>.</p><h3 id="run-options"><span class="mr-2">run options</span><a href="#run-options" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><code class="language-plaintext highlighter-rouge">--name=custom_name</code> Assign a custom name to your container<li><code class="language-plaintext highlighter-rouge">--rm</code> Automatically remove the container when it exits<li><code class="language-plaintext highlighter-rouge">-p host_port:container_port</code> Map a port from inside the container to a port on your host machine<li><code class="language-plaintext highlighter-rouge">-v /host/path:/container/path</code> Mount a volume to save persistent files<li><code class="language-plaintext highlighter-rouge">-e "ENV_VAR_NAME=value"</code> Setting a environment variable<li><code class="language-plaintext highlighter-rouge">-it</code> Run container in interactive mode with a TTY (simulated terminal)</ul><p>You can set different restart policies, too.</p><ul><li><code class="language-plaintext highlighter-rouge">--restart=no</code> (Default): Do not automatically restart the container<li><code class="language-plaintext highlighter-rouge">--restart=always</code> Always restart the container if it stops<li><code class="language-plaintext highlighter-rouge">--restart=unless-stopped</code> Restart the container unless it has been stopped manually<li><code class="language-plaintext highlighter-rouge">--restart=on-failure:6</code> Restart the container if it exits due to an error (non-zero exit status). You can also specify a maximum number of restarts.</ul><h2 id="nvidia-gpu-passthrough"><span class="mr-2">Nvidia GPU Passthrough</span><a href="#nvidia-gpu-passthrough" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If you need to use a gpu inside a container e.g. for video transcoding or machine learning then your container needs to have the necessary drivers installed. The easiest way to achieve this is to just use a prebuilt cuda base image.</p><div class="language-Dockerfile highlighter-rouge"><div class="code-header"> <span data-label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> nvidia/cuda:12.1.0-base-ubuntu22.04</span>
</pre></table></code></div></div><p>If you decide to use a ubuntu base image you may have to use this after the <code class="language-plaintext highlighter-rouge">FROM</code> command:</p><div class="language-Dockerfile highlighter-rouge"><div class="code-header"> <span data-label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">RUN </span>apt-get update <span class="o">&amp;&amp;</span> <span class="se">\
</span>    <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive <span class="nv">TZ</span><span class="o">=</span>Etc/UTC apt-get <span class="nb">install</span> <span class="nt">-y</span> tzdata
</pre></table></code></div></div><p>Otherwise the container expects user input during the build that you obviously cant provide.</p><p>If you want to make your image as small as possible you can use <code class="language-plaintext highlighter-rouge">rm -rf /var/lib/apt/lists/*</code> at the end of your <code class="language-plaintext highlighter-rouge">RUN</code> instruction to remove the no longer needed apt files.</p><p>To make GPUs accessible inside the container use <code class="language-plaintext highlighter-rouge">--gpu all</code> in the docker run command. If you want to use one or more specific GPUs add <code class="language-plaintext highlighter-rouge">--gpus all -e NVIDIA_VISIBLE_DEVICES=GPU-UUID-HERE</code>. To list all available GPUs and the UUIDs run <code class="language-plaintext highlighter-rouge">nvidia-smi -L</code>. The <code class="language-plaintext highlighter-rouge">nvidia-smi</code> command can also be used to verify what GPUs are visible inside the container like this:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker <span class="nb">exec</span> <span class="nt">-it</span> container_name_or_id nvidia-smi
</pre></table></code></div></div><h2 id="command-overview"><span class="mr-2">Command Overview</span><a href="#command-overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Start a container:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker start helloworld
</pre></table></code></div></div><p>Stop a container:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker stop helloworld
</pre></table></code></div></div><p>Show all running containers:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker ps
</pre></table></code></div></div><p>Show all containers:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker ps <span class="nt">-a</span>
</pre></table></code></div></div><p>Show all images:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker images
</pre></table></code></div></div><p>Show all volumes:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker volume <span class="nb">ls</span>
</pre></table></code></div></div><p>Show all networks:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker network <span class="nb">ls</span>
</pre></table></code></div></div><p>ssh into a container</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker <span class="nb">exec</span> <span class="nt">-it</span> helloworld /bin/bash <span class="c">#helloworld is the name of the container</span>
</pre></table></code></div></div><p>or</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>  docker <span class="nb">exec</span> <span class="nt">--tty</span> helloworld /bin/bash <span class="c">#helloworld is the name of the container</span>
</pre></table></code></div></div><p>send a command to a container</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker <span class="nb">exec </span>helloworld <span class="nb">ls</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/linux/'>linux</a>, <a href='/categories/docker/'>docker</a>, <a href='/categories/containers/'>containers</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/documentation/" class="post-tag no-text-decoration" >documentation</a> <a href="/tags/arm64/" class="post-tag no-text-decoration" >arm64</a> <a href="/tags/amd64/" class="post-tag no-text-decoration" >amd64</a> <a href="/tags/webserver/" class="post-tag no-text-decoration" >webserver</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Docker+-+Saracen+Rhue&url=%2Fposts%2Fdocker%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Docker+-+Saracen+Rhue&u=%2Fposts%2Fdocker%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2Fdocker%2F&text=Docker+-+Saracen+Rhue" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/proxmox/">Proxmox</a><li><a href="/posts/docker/">Docker</a><li><a href="/posts/java/">Java</a><li><a href="/posts/linux/">Linux</a><li><a href="/posts/tmux/">Tmux</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/documentation/">documentation</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/servers/">servers</a> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/terminal/">terminal</a> <a class="post-tag" href="/tags/install/">install</a> <a class="post-tag" href="/tags/webdev/">webdev</a> <a class="post-tag" href="/tags/automation/">automation</a> <a class="post-tag" href="/tags/shell/">shell</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/kubernetes/"><div class="card-body"> <em class="small" data-ts="1717970400" data-df="ll" > Jun 10, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Kubernetes Cluster on Raspberry Pi</h3><div class="text-muted small"><p> Preperation Prep all the Raspberry Pis with the lite non desktop 64bit version of Raspberry Pi OS. Be shure to set a unique hostname for each Raspberry Pi. Install k3s ssh into the first node wh...</p></div></div></a></div><div class="card"> <a href="/posts/homebrew/"><div class="card-body"> <em class="small" data-ts="1663452000" data-df="ll" > Sep 18, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Homebrew</h3><div class="text-muted small"><p> Homebrew is a package manager for macOS. It is similar to apt, yum, and other package managers. It can be used on Debian or Fedora Linux as well. pros packages are up to date easy to use i...</p></div></div></a></div><div class="card"> <a href="/posts/nix/"><div class="card-body"> <em class="small" data-ts="1663538400" data-df="ll" > Sep 19, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Nix</h3><div class="text-muted small"><p> Nix is a package manager for Linux. It is similar to apt, yum, and other package managers. pros packages are up to date very fast cons unintuitive command names no full arm64 support...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/css_libraries/" class="btn btn-outline-primary" prompt="Older"><p>Useful CSS Libraries</p></a> <a href="/posts/go/" class="btn btn-outline-primary" prompt="Newer"><p>Go</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/SaracenRhue">Saracen Rhue</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/documentation/">documentation</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/servers/">servers</a> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/terminal/">terminal</a> <a class="post-tag" href="/tags/install/">install</a> <a class="post-tag" href="/tags/webdev/">webdev</a> <a class="post-tag" href="/tags/automation/">automation</a> <a class="post-tag" href="/tags/shell/">shell</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
